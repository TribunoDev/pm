{% extends 'base.html' %}

{% block titulo %}Paper & More{% endblock %}
{% block style %}
	<style>
		
	</style>
{% endblock %}
{% block js %}
	<script>
		$('#btnFiltroSubcat').on('click', function(){
			$.ajax({
				type: 	'POST',
				url: 	'/filtro-marca-subcategoria/',
				data: 	{
					'marca': $('input[name="marca"]').val(),
					'subcategoria': $('select[name="subcategoria"]').val(),
					'existencia': $('select[name="existencia"]').val(),
					'csrfmiddlewaretoken': $('input[name="csrfmiddlewaretoken"]').val()
				},
				success: function(data){
					$('#marcas-subcategorias').html(data);
				},
				dataType: 'html'
			});
		});
	</script>
{% endblock %}
{% block contenido %}
	<ol class="breadcrumb">
		<li><a href="/">Inicio</a></li>
	  	<li><a href="/marcas/">Marcas</a></li>
	  	<li class="active">{{marca.Marca}}</li>
	</ol>
	<div class="row filtro-marcas">
		<form class="form-inline" role="form">
			{% csrf_token %}
				<input type="hidden" name="marca" value="{{marca.Marca}}">
				<div class="form-group">
					<select name="subcategoria" id="selectSubcategoria" class="form-control filtroSelect" required>
						<option value="all">TODOS LOS PRODUCTOS...</option>
			  			{% for subcategoria in subcategorias %}
		    			<option value="{{subcategoria.Subcategoria}}">{{subcategoria.Subcategoria}}</option>
			  			{% endfor %}
		    		</select>
		    	</div>
		    	<div class="form-group">
		    		<select name="existencia" id="selectExistencia" class="filtroSelect form-control" required>
						<option value="0">TODOS...</option>
			    		<option value="1">CON EXISTENCIAS</option>
			    		<option value="2">SIN EXISTENCIAS</option>
			    	</select>
		    	</div>
	    		<button id="btnFiltroSubcat" type="button" class="btn btn-info btn-sm btnFiltro">Mostrar</button>	
		</form>
	</div>
	<div class="row">
		<article id="caja-contenido" class="col-xs-12 col-sm-8 col-md-9">
			<div class="contenido-titulo row">
				<h2 class="titulo">{{marca.Marca}}</h2>
			</div>
			<div  class="row" id="marcas-subcategorias">
				<article  class="cuerpo-contenido row">
					{% for elemento in productos %}
					   <div class="producto-elemento col-xs-6 col-sm-6 col-md-4">
					    <div class="thumbnail">
				    		{% if elemento.Oferta %}
				                <img src="{{STATIC_URL}}img/img_oferta.png" class="img_oferta">
				            {% endif %}
							<a href="/detalle-producto/{{elemento.Codigo}}">
								<img src="{{MEDIA_URL}}{{elemento.Imagen}}" class="img-thumbnail">
							</a>
				      		<div class="caption">
				        		<h3 class="nombre-producto">{{elemento.Descripcion|truncatewords:10}}</h3>
				        		<p class="caption-precio">L. {{elemento.Precio}}</p>
				        		<form method="post" action="/agregar-carrito/">{% csrf_token %}
				        			<input type="hidden" value="{{elemento.Codigo}}" name="Producto">
				        			<input type="hidden" value="1" name="Cantidad">
				        			<p class="producto-caja-btn">
				        			<button class="btn btn-primary" type="submit"><span class='icon-carrito icon-carritocart'></button> <a href="/detalle-producto/{{elemento.Codigo}}" class="btn btn-default" role="button">Detalles</a></p>
				        			
				        		</form>
				      		</div>
				    	</div>
					  </div>
					 {% empty %}
					 	<div class="alert alert-warning">
					 		<h3>No hay productos disponible para esta marca.</h3>
					 	</div>
					{% endfor %}
				</article>
				{% if totalProductos > 18 %}
				<article class="cuerpo-contenido row paginacion">
					<ul class="pagination">
						<li class="{% if not productos.has_previous %}disabled{% endif %}">
							{% if not productos.has_previous %}
								<a class="">Inicio</a>
							{% else %}
								<a href="?page=1" class="">Inicio</a>
							{% endif %}
						</li>
						<li class="{% if not productos.has_previous %}disabled{% endif %}">
							{% if not productos.has_previous %}
								<a class="">Anterior</a>
							{% else %}
								<a href="?page={{productos.previous_page_number}}" class="">Anterior</a>
							{% endif %}
						</li>
						{% for page in page_number %}
							{% if page == productos.number %}
								
									<li class="active"><a class="visible-lg">{{page}}</a></li>
								
							{% else %}
								<li><a class="visible-lg" href="?page={{ page }}">{{ page }}</a></li>
							{% endif %}
						{% endfor %}
						<li class="{% if not productos.has_next %}disabled{% endif %}">
							{% if not productos.has_next %}
								<a class="">Siguiente</a>
							{% else %}
								<a href="?page={{productos.next_page_number}}" class="" >Siguiente</a>
							{% endif %}
						</li>
						<li class="{% if not productos.has_next %}disabled{% endif %}">
							{% if not productos.has_next %}
								<a class="">Ultimo</a>
							{% else %}
								<a href="?page={{productos.paginator.num_pages}}" class="">Ultimo</a>
							{% endif %}
						</li>
					</ul>
				</article>
				{% endif %}
			</div>
		</article>
		<article id="contenido-lateral" class="hidden-xs col-sm-4 col-md-3 contenido-lateral" >
			<div class="row producto-filtro-lateral">
                <div class="row">
                    <h2 class="titulo">Novedades</h2>
                </div>
                <div  class="cuerpo-contenido row">
					{% for item in novedades %}
					<article class="producto-elemento row">
							<div class="detalle-codigo row"><p><strong>Código:</strong> {{item.Codigo}}</p></div>
							<div class="row">
								<figure id="s2" class="s2 demo">
		                            <img src="{{MEDIA_URL}}{{item.Imagen}}" >          
	                            </figure>
								<div class="contenido-lateral-precio">
									<div class="row">
										<h3 ><span class="label label-success">L. {{item.Precio}}</span></h3>
									</div>
									<div class="row producto-caja-btn">
	                                    <form method="post" action="/agregar-carrito/">{% csrf_token %}
	                                        <input type="hidden" value="{{item.Codigo}}" name="Producto">
	                                        <input type="hidden" value="1" name="Cantidad">
	                                        <button class="btn btn-primary" type="submit"><span class='icon-carrito icon-carritocart'></button> <a href="/detalle-producto/{{item.Codigo}}" class="btn btn-default" role="button">Ver</a></p>
	                                    </form>
	                                </div>
								</div>
							</div>
							<div class="row detalle-descripcion"><p>{{item.Descripcion|truncatewords:8}}</p></div>
						</article>
					{% endfor %}
				</div>
            </div>
			<div class="row producto-filtro-lateral">
				<div class="row">
					<h2 class="titulo">Ofertas</h2>
				</div>
				<div  class="cuerpo-contenido row">
					{% for item in ofertas %}
					<article class="producto-elemento row">
						<div class="detalle-codigo row"><p><strong>Código:</strong> {{item.Codigo}}</p></div>
						<div class="row">
							<figure id="s2" class="s2 demo">
	                            <img src="{{MEDIA_URL}}{{item.Imagen}}" >              
                            </figure>
							<div class="contenido-lateral-precio">
								<div class="row">									
									<h3 ><span class="label label-success">L. {{item.Precio}}</span></h3>
								</div>
								<div class="row producto-caja-btn">
                                    <form method="post" action="/agregar-carrito/">{% csrf_token %}
                                        <input type="hidden" value="{{item.Codigo}}" name="Producto">
                                        <input type="hidden" value="1" name="Cantidad">
                                        <button class="btn btn-primary" type="submit"><span class='icon-carrito icon-carritocart'></button> <a href="/detalle-producto/{{item.Codigo}}" class="btn btn-default" role="button">Ver</a></p>
                                    </form>
                                </div>
							</div>
						</div>
						<div class="row detalle-descripcion"><p>{{item.Descripcion|truncatewords:8}}</p></div>
					</article>
					{% endfor %}
				</div>
			</div>
			<div class="row espacio"></div>
			<div class="row producto-filtro-lateral">
				<div class="row">
					<h2 class="titulo">Destacados</h2>
				</div>
				<div  class="cuerpo-contenido row">
					{% for item in destacados %}
					<article class="producto-elemento row">
						<div class="detalle-codigo row"><p><strong>Código:</strong> {{item.Codigo}}</p></div>
						<div class="row">
							<figure id="s2" class="s2 demo">
	                            <img src="{{MEDIA_URL}}{{item.Imagen}}" >               
                            </figure>
							<div class="contenido-lateral-precio">
								<div class="row">									
									<h3 ><span class="label label-success">L. {{item.Precio}}</span></h3>
								</div>
								<div class="row producto-caja-btn">
                                    <form method="post" action="/agregar-carrito/">{% csrf_token %}
                                        <input type="hidden" value="{{item.Codigo}}" name="Producto">
                                        <input type="hidden" value="1" name="Cantidad">
                                        <button class="btn btn-primary" type="submit"><span class='icon-carrito icon-carritocart'></button> <a href="/detalle-producto/{{item.Codigo}}" class="btn btn-default" role="button">Ver</a></p>
                                    </form>
                                </div>
							</div>
						</div>
						<div class="row detalle-descripcion"><p>{{item.Descripcion|truncatewords:8}}</p></div>
					</article>
					{% endfor %}
				</div>
			</div>
		</article>
	</div>
{% endblock %}